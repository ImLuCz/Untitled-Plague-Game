export const questionsIta = [
  //1 domanda
  {
    question: "In che anno arriva la peste a Firenze?",
    options: ["1248", "1350", "1348", "1340"],
    answer: "1348",
  },
  //2 domanda
  {
    question: "Quale di queste tipologie di peste non esiste?",
    options: [
      "Peste nera",
      "Peste setticemica",
      "Peste neurologica",
      "Peste bubbonica",
    ],
    answer: "Peste neurologica",
  },
  //3 domanda
  {
    question: "Qual è la città più popolata negli anni del XIV secolo?",
    options: ["Parigi", "Venezia", "Milano", "Firenze"],
    answer: "Parigi",
  },
  //4 domanda
  {
    question:
      "Quanti sono realmente i giorni che i ragazzi del Decameron hanno passato nella villa?",
    options: ["10", "12", "14", "13"],
    answer: "14",
  },
  //5 domanda
  {
    question: "Quanti morti ha causato la peste a Firenze?",
    options: [
      "5000",
      "Circa il 50% della popolazione",
      "Oltre 300.000",
      "Meno di 1000",
    ],
    answer: "Circa il 50% della popolazione",
  },
  //6 domanda
  {
    question: "Quanti sono i ragazzi nella villa del Decameron?",
    options: ["8", "10", "12", "9"],
    answer: "10",
  },
  //7 domanda
  {
    question: "Boccaccio da piccolo in che città si stabilisce?",
    options: ["Firenze", "Milano", "Palermo", "Napoli"],
    answer: "Napoli",
  },
  //8 domanda
  {
    question: "Le autorità che restrizione misero dopo l'arrivo della peste?",
    options: [
      "Quarantena",
      "Uscire solo di sera",
      "Uscire solo di giorno",
      "Flagellarsi per la città",
    ],
    answer: "Quarantena",
  },
  //9 domanda
  {
    question: "Chi furono incolpati per la diffusione della peste?",
    options: ["Gli spagnoli", "I napoletani", "Gli ungheresi", "Gli ebrei"],
    answer: "Gli ebrei",
  },
  //10 domanda
  {
    question: "Dove nasce Boccaccio?",
    options: ["Avignone", "Napoli", "Milano", "Non è sicuro"],
    answer: "Non è sicuro",
  },
  //11 domanda
  {
    question: "In che anno nasce Boccaccio?",
    options: ["1311", "1312", "1313", "1310"],
    answer: "1313",
  },
  //12 domanda
  {
    question: "In che anno la peste inizia ad indebolirsi?",
    options: ["1351", "1348", "1352", "1360"],
    answer: "1351",
  },
  //13 domanda
  {
    question: "In che secolo si afferma la corrente poetica dell'umanesimo?",
    options: ["XII", "XI", "XVII", "XV"],
    answer: "XV",
  },
  //14 domanda
  {
    question: "Cosa accade tra il 1315 e il 1317?",
    options: [
      "Crisi demografica",
      "Crisi economica",
      "Crisi di potere",
      "Crisi agricola",
    ],
    answer: "Crisi agricola",
  },
  //15 domanda
  {
    question: "Quale università fu fondata nel 1088?",
    options: [
      "Università di Pavia",
      "Università di Bologna",
      "Università di Milano",
      "Università di Firenze",
    ],
    answer: "Università di Bologna",
  },
  //16 domanda
  {
    question: "In che anno la sede papale fu spostata ad Avignone?",
    options: ["1310", "1340", "1307", "1309"],
    answer: "1309",
  },
  //17 domanda
  {
    question: "In che anno finisce la cattività avignonese?",
    options: ["1380", "1377", "1367", "1370"],
    answer: "1377",
  },
  //18 domanda
  {
    question: "Quando inizia la guerra dei Cent'anni?",
    options: ["1337", "1340", "1333", "1335"],
    answer: "1337",
  },
  //19 domanda
  {
    question: "Quando venne concluso il Decameron?",
    options: ["1350", "1343", "1353", "1363"],
    answer: "1353",
  },
  //20 domanda
  {
    question: "Dove muore Boccaccio?",
    options: ["Verona", "Firenze", "Napoli", "Certaldo"],
    answer: "Certaldo",
  },
  //21 domanda
  {
    question: "Cosa sono i lazzaretti?",
    options: [
      "Strutture di isolamento per persone affette da malattie contagiose",
      "Strutture religiose",
      "Grandi città con tanti malati",
      "Luogo di incontro per studiosi",
    ],
    answer:
      "Strutture di isolamento per persone affette da malattie contagiose",
  },
  //22 domanda
  {
    question:
      "Quale animale venne erroneamente sterminato perché si pensava fosse responsabile della Peste Nera?",
    options: ["Il gatto", "Il cane", "La tigre", "Il cavallo"],
    answer: "Il gatto", 
  },
  //23 domanda
  {
    question: "Qual era la causa principale della diffusione della Peste Nera?",
    options: [
      "L'inquinamento",
      "Le pulci sui ratti",
      "Cibo avariato",
      "Medicina medievale",
    ],
    answer: "Le pulci sui ratti",
  },
  //24 domanda
  {
    question:
      "Quale fu l'origine geografica della Peste Nera prima di arrivare in Europa?",
    options: ["Africa", "Asia centrale", "America del Nord", "Oceania"],
    answer: "Asia centrale",
  },
  //25 domanda
  {
    question:
      "Quale cambiamento economico fu causato dalla riduzione della popolazione dovuta alla peste?",
    options: [
      "Aumento dei salari per i lavoratori",
      "Crollo del commercio",
      "Abolizione della proprietà terriera",
      "Creazione di nuove città",
    ],
    answer: "Aumento dei salari per i lavoratori",
  },
  //26 domanda
  {
    question:
      "Secondo le credenze del tempo la peste si diffonde anche per cosa?",
    options: [
      "Per il contatto di acqua",
      "Per il cattivo odore",
      "Per via degli spagnoli",
      "Per volere del papa",
    ],
    answer: "Per il cattivo odore",
  },
  //27 domanda
  {
    question:
      "Quale gruppo sociale fu colpito più duramente dalle conseguenze economiche della Peste Nera?",
    options: ["Contadini", "Mercanti", "Nobili", "Artigiani"],
    answer: "Contadini",
  },
  //28 domanda
  {
    question: "Che cosa sono le jacqueries?",
    options: [
      "Strutture difensive",
      "Eserciti di mercenari",
      "Zone per malati",
      "Insurrezioni contadine",
    ],
    answer: "Insurrezioni contadine",
  },
  //29 domanda
  {
    question: "Chi erano i Ciompi?",
    options: [
      "Falegnami",
      "Operai della lana",
      "Operai della seta",
      "Agricoltori",
    ],
    answer: "Operai della lana",
  },
  //30 domanda
  {
    question: "Quando finisce la guerra dei Cent'anni?",
    options: ["1443", "1453", "1437", "1441"],
    answer: "1453",
  },
  //31 domanda
  {
    question: "Chi vinse la guerra dei Cent'anni?",
    options: ["Inghilterra", "Italia", "Spagna", "Francia"],
    answer: "Francia",
  },
  //32 domanda
  {
    question: "Chi erano i flagellanti?",
    options: [
      "Si frustavano in pubblico",
      "Correvano per la città",
      "Malati di peste",
      "Fuggivano",
    ],
    answer: "Si frustavano in pubblico",
  },
  //33 domanda
  {
    question:
      "Chi era il sovrano d'Inghilterra all'inizio della Guerra dei Cent'anni?",
    options: ["Edoardo III", "Riccardo II", "Enrico V", "Giovanni II"],
    answer: "Edoardo III",
  },
  //34 domanda
  {
    question: "Quale città NON era tra le più grandi d'Europa nel XIV secolo?",
    options: ["Londra", "Napoli", "Berlino", "Parigi"],
    answer: "Berlino",
  },
  //35 domanda
  {
    question:
      "Quale figura storica fu associata alla fine della Guerra dei Cent'anni?",
    options: [
      "Giovanna d'Arco",
      "Federico II",
      "Carlo Magno",
      "Cosimo de' Medici",
    ],
    answer: "Giovanna d'Arco",
  },
  //36 domanda
  {
    question:
      "Quale fra questi elementi NON era una misura adottata contro la peste?",
    options: [
      "Lazzaretti",
      "Divieto di commercio",
      "Sterminio delle api",
      "Uso di maschere",
    ],
    answer: "Sterminio delle api",
  },
  //37 domanda
  {
    question: "Quale fra questi NON fu una conseguenza della Peste Nera?",
    options: [
      "Mobilità sociale",
      "Crisi del feudalesimo",
      "Incremento demografico",
      "Richiesta di manodopera",
    ],
    answer: "Incremento demografico",
  },
  //38 domanda
  {
    question: "Cosa accade alla popolazione europea nel XIV secolo?",
    options: ["Crescita", "Stasi", "Drastica diminuzione", "Urbanizzazione"],
    answer: "Drastica diminuzione",
  },
  //39 domanda
  {
    question: "Chi erano i beccamorti?",
    options: [
      "Coloro che raccoglievano i cadaveri",
      "Medici",
      "Preti",
      "Ufficiali",
    ],
    answer: "Coloro che raccoglievano i cadaveri",
  },
  //40 domanda
  {
    question: "Cosa significava la bandiera gialla su una casa?",
    options: [
      "Contagiati",
      "Medici presenti",
      "Famiglia ricca",
      "Casa abbandonata",
    ],
    answer: "Contagiati",
  },
  //41 domanda
  {
    question: "Perché la peste si diffuse rapidamente nei porti?",
    options: [
      "Per il commercio marittimo",
      "Per la povertà",
      "Per le fogne",
      "Per i marinai malati",
    ],
    answer: "Per il commercio marittimo",
  },
  //42 domanda
  {
    question: "Quale funzione avevano le campane durante la peste?",
    options: [
      "Segnalare morti",
      "Chiamare a raccolta",
      "Allontanare spiriti",
      "Riconoscere i guariti",
    ],
    answer: "Segnalare morti",
  },
  //43 domanda
  {
    question: "Quale fu la causa della crisi agricola del 1315-1317?",
    options: ["Piogge incessanti", "Guerra", "Scioperi", "Inflazione"],
    answer: "Piogge incessanti",
  },
  // 44 domanda
  {
    question: "Qual era il principale mezzo di trasporto del contagio?",
    options: ["Navi", "Cavalli", "Carrozze", "Pellegrini"],
    answer: "Navi",
  },
  //45 domanda
  {
    question: "Perché la medicina medievale fu inefficace contro la peste?",
    options: [
      "Ignorava la vera causa",
      "Era troppo cara",
      "Non era diffusa",
      "Usava troppe erbe",
    ],
    answer: "Ignorava la vera causa",
  },
  //46 domanda
  {
    question: "Cosa simboleggiava il colore nero nella peste?",
    options: ["Morte", "Speranza", "Ricchezza", "Potere"],
    answer: "Morte",
  },
  //47 domanda
  {
    question: "Dove si trovavano spesso i lazzaretti?",
    options: ["Fuori città", "Al centro città", "In conventi", "In mercati"],
    answer: "Fuori città",
  },
  //48 domanda
  {
    question: "Qual era uno dei sintomi tipici della peste bubbonica?",
    options: ["Bubboni", "Tosse", "Cecità", "Febbre lieve"],
    answer: "Bubboni",
  },
  //49 domanda
  {
    question: "Cosa accadde all'arte durante la peste?",
    options: [
      "Si oscurò",
      "Si fermò",
      "Divenne allegra",
      "Si concentrò sul paesaggio",
    ],
    answer: "Si oscurò",
  },
  //50 domanda
  {
    question: "Quale cambiamento culturale fu favorito dalla Peste Nera?",
    options: [
      "Declino della fede religiosa",
      "Maggiore diffusione dell'arte funeraria",
      "Crescita del pensiero umanistico",
      "Espansione dei monasteri",
    ],
    answer: "Crescita del pensiero umanistico",
  },
];

export const questionsEng = [
//1 question
{
  question: 'In which year did the plague arrive in Florence?',
  options: ['1248', '1350', '1348', '1340'],
  answer: '1348'
},
//2 question
{
  question: 'Which of these types of plague does not exist?',
  options: ['Black plague', 'Septicaemic plague', 'Neurological plague', 'Bubonic plague'],
  answer: 'Neurological plague'
},
//3 question
{
  question: 'Which city was the most populated during the 14th century?',
  options: ['Paris', 'Venice', 'Milan', 'Florence'],
  answer: 'Paris'
},
//4 question
{
  question: 'How many days did the characters in the Decameron actually spend in the villa?',
  options: ['10', '12', '14', '13'],
  answer: '14'
},
//5 question
{
  question: 'How many deaths did the plague cause in Florence?',
  options: ['5000', 'About 50% of the population', 'Over 300,000', 'Less than 1000'],
  answer: 'About 50% of the population'
},
//6 question
{
  question: 'How many people were there in the Decameron villa?',
  options: ['8', '10', '12', '9'],
  answer: '10'
},
//7 question
{
  question: 'Where did Boccaccio settle as a child?',
  options: ['Florence', 'Milan', 'Palermo', 'Naples'],
  answer: 'Naples'
},
//8 question
{
  question: 'What restrictions did the authorities impose after the arrival of the plague?',
  options: ['Quarantine', 'Go out only at night', 'Go out only during the day', 'Flagellate through the city'],
  answer: 'Quarantine'
},
//9 question
{
  question: 'Who was blamed for spreading the plague?',
  options: ['The Spaniards', 'The Neapolitans', 'The Hungarians', 'The Jews'],
  answer: 'The Jews'
},
//10 question
{
  question: 'Where was Boccaccio born?',
  options: ['Avignon', 'Naples', 'Milan', 'Uncertain'],
  answer: 'Uncertain'
},
//11 question
{
  question: 'In which year was Boccaccio born?',
  options: ['1311', '1312', '1313', '1310'],
  answer: '1313'
},
//12 question
{
  question: 'In which year did the plague begin to weaken?',
  options: ['1351', '1348', '1352', '1360'],
  answer: '1351'
},
//13 question
{
  question: 'In which century did the poetic movement of humanism emerge?',
  options: ['12th', '11th', '17th', '15th'],
  answer: '15th'
},
//14 question
{
  question: 'What happened between 1315 and 1317?',
  options: ['Demographic crisis', 'Economic crisis', 'Power crisis', 'Agricultural crisis'],
  answer: 'Agricultural crisis'
},
//15 question
{
  question: 'Which university was founded in 1088?',
  options: ['University of Pavia', 'University of Bologna', 'University of Milan', 'University of Florence'],
  answer: 'University of Bologna'
},
//16 question
{
  question: 'In which year was the papal seat moved to Avignon?',
  options: ['1310', '1340', '1307', '1309'],
  answer: '1309'
},
//17 question
{
  question: 'In which year did the Avignon Papacy end?',
  options: ['1380', '1377', '1367', '1370'],
  answer: '1377'
},
//18 question
{
  question: 'When did the Hundred Years\' War begin?',
  options: ['1337', '1340', '1333', '1335'],
  answer: '1337'
},
//19 question
{
  question: 'When was the Decameron completed?',
  options: ['1350', '1343', '1353', '1363'],
  answer: '1353'
},
//20 question
{
  question: 'Where did Boccaccio die?',
  options: ['Verona', 'Florence', 'Naples', 'Certaldo'],
  answer: 'Certaldo'
},
//21 question
{
  question: 'What are lazarettos?',
  options: [
    'Isolation facilities for people with contagious diseases',
    'Religious structures',
    'Large cities with many sick people',
    'Meeting places for scholars'
  ],
  answer: 'Isolation facilities for people with contagious diseases'
},
//22 question
{
  question: 'Which animal was mistakenly exterminated because it was believed to be responsible for the Black Death?',
  options: ['The cat', 'The dog', 'The tiger', 'The horse'],
  answer: 'The cat'
},
//23 question
{
  question: 'What was the main cause of the spread of the Black Death?',
  options: ['Pollution', 'Fleas on rats', 'Rotten food', 'Medieval medicine'],
  answer: 'Fleas on rats'
},
//24 question
{
  question: 'What was the geographical origin of the Black Death before it reached Europe?',
  options: ['Africa', 'Central Asia', 'North America', 'Oceania'],
  answer: 'Central Asia'
},
//25 question
{
  question: 'What economic change was caused by the population reduction due to the plague?',
  options: ['Increase in workers\' wages', 'Collapse of trade', 'Abolition of land ownership', 'Creation of new cities'],
  answer: 'Increase in workers\' wages'
},
//26 question
{
  question: 'According to beliefs at the time, how did the plague spread?',
  options: ['Through water contact', 'Through bad smells', 'Through the Spaniards', 'By the Pope\'s will'],
  answer: 'Through bad smells'
},
//27 question
{
  question: 'Which social group was hit hardest by the economic consequences of the Black Death?',
  options: ['Peasants', 'Merchants', 'Nobles', 'Artisans'],
  answer: 'Peasants'
},
//28 question
{
  question: 'What are jacqueries?',
  options: ['Defensive structures', 'Mercenary armies', 'Zones for sick people', 'Peasant uprisings'],
  answer: 'Peasant uprisings'
},
//29 question
{
  question: 'Who were the Ciompi?',
  options: ['Carpenters', 'Wool workers', 'Silk workers', 'Farmers'],
  answer: 'Wool workers'
},
//30 question
{
  question: 'When did the Hundred Years\' War end?',
  options: ['1443', '1453', '1437', '1441'],
  answer: '1453'
},
//31 question
{
  question: 'Who won the Hundred Years\' War?',
  options: ['England', 'Italy', 'Spain', 'France'],
  answer: 'France'
},
//32 question
{
  question: 'Who were the flagellants?',
  options: ['They whipped themselves in public', 'They ran through the city', 'They were plague victims', 'They fled'],
  answer: 'They whipped themselves in public'
},
//33 question
{
  question: 'Who was the King of England at the start of the Hundred Years\' War?',
  options: ['Edward III', 'Richard II', 'Henry V', 'John II'],
  answer: 'Edward III'
},
//34 question
{
  question: 'Which city was NOT one of the largest in Europe in the 14th century?',
  options: ['London', 'Naples', 'Berlin', 'Paris'],
  answer: 'Berlin'
},
//35 question
{
  question: 'Which historical figure is associated with the end of the Hundred Years\' War?',
  options: ['Joan of Arc', 'Frederick II', 'Charlemagne', 'Cosimo de\' Medici'],
  answer: 'Joan of Arc'
},
//36 question
{
  question: 'Which of these was NOT a measure adopted against the plague?',
  options: ['Lazarettos', 'Ban on trade', 'Extermination of bees', 'Use of masks'],
  answer: 'Extermination of bees'
},
//37 question
{
  question: 'Which of these was NOT a consequence of the Black Death?',
  options: ['Social mobility', 'Crisis of feudalism', 'Demographic increase', 'Labor demand'],
  answer: 'Demographic increase'
},
//38 question
{
  question: 'What happened to the European population in the 14th century?',
  options: ['Growth', 'Stagnation', 'Sharp decline', 'Urbanization'],
  answer: 'Sharp decline'
},
//39 question
{
  question: 'Who were the "beccamorti"?',
  options: ['Those who collected the bodies', 'Doctors', 'Priests', 'Officials'],
  answer: 'Those who collected the bodies'
},
//40 question
{
  question: 'What did the yellow flag on a house mean?',
  options: ['Contaminated', 'Doctors present', 'Wealthy family', 'Abandoned house'],
  answer: 'Contaminated'
},
//41 question
{
  question: 'Why did the plague spread quickly in ports?',
  options: ['Through maritime trade', 'Through poverty', 'Through sewers', 'Through sick sailors'],
  answer: 'Through maritime trade'
},
//42 question
{
  question: 'What was the role of bells during the plague?',
  options: ['To signal deaths', 'To call gatherings', 'To drive away spirits', 'To recognize the cured'],
  answer: 'To signal deaths'
},
//43 question
{
  question: 'What led to the agricultural crisis of 1315-1317?',
  options: ['Relentless rain', 'War', 'Strikes', 'Inflation'],
  answer: 'Relentless rain'
},
//44 question
{
  question: "What was the main means of transport for the spread of the plague?",
  options: ["Ships", "Horses", "Carriages", "Pilgrims"],
  answer: "Ships"
},
//45 question 
{
  question: "Why was medieval medicine ineffective against the plague?",
  options: ["Ignored the true cause", "Was too expensive", "Was not widespread", "Used too many herbs"],
  answer: "Ignored the true cause"
},
//46 question 
{
  question: "What did the color black symbolize in the plague?",
  options: ["Death", "Hope", "Wealth", "Power"],
  answer: "Death"
},
//47 question 
{
  question: "Where were lazarettos often located?",
  options: ["Outside the city", "In the city center", "In convents", "In markets"],
  answer: "Outside the city"
},
//48 question 
{
  question: "What was one of the typical symptoms of bubonic plague?",
  options: ["Buboes", "Cough", "Blindness", "Mild fever"],
  answer: "Buboes"
},
//49 question 
{
  question: "What happened to art during the plague?",
  options: ["Became darker", "Stopped", "Became cheerful", "Focused on landscapes"],
  answer: "Became darker"
},
//50 question 
{
  question: "What cultural change was encouraged by the Black Death?",
  options: ["Decline in religious faith", "Greater spread of funerary art", "Growth of humanistic thought", "Expansion of monasteries"],
  answer: "Growth of humanistic thought"
}
]

const categories = [
  "cell", // Cell effect
  "question", // [SPECIAL] Question
  "death", // [SPECIAL] Death
  "bonus", // [SPECIAL] Bonus
];

const weights = [
  45, // Weight for "cell"
  30, // Weight for "questions"
  10, // Weight for "death"
  15, // Weight for "bonus"
];

function weightedRandomCategory(categories, weights) {
  const totalWeight = weights.reduce((acc, val) => acc + val, 0);
  let r = Math.random() * totalWeight;
  for (let i = 0; i < categories.length; i++) {
    if (r < weights[i]) return i;
    r -= weights[i];
  }
  return categories.length - 1; // fallback
}

export function generateEffects(totalCells = 63) {
  //#region Global
  // Global Settings
  const alwaysExcludedCount = 2; // Cells that are always exluded (cell 1 and cell 63)
  const maxEffects = 35;

  // Global Vars
  let appliedEffects = 0; // Number of effects already applied
  const availableCells = totalCells - alwaysExcludedCount;
  const categoryCounts = [0, 0, 0, 0, 0]; // Track how many times each category is applied
  const excludedCells = new Set([1, totalCells]); // Excluded cells + already used cells
  const finalEffect = {};
  //#endregion
  // Question effect Settings
  const minQuestions = 3,
    maxQuestions = 6;

  // Cell effect Settings
  const cellEffectRange = 6; // Max signed movement for cell effect

  for (let i = 1; i < totalCells; ++i) {
    finalEffect[i] = { type: "empty" };
  }

  finalEffect[0] = { type: "start" };
  finalEffect[totalCells] = { type: "final" };

  // Question pool setup outside while loop (only once)
  let shuffledQuestionsIta = [...questionsIta].sort(() => 0.5 - Math.random());
  let shuffledQuestionsEng = [...questionsEng].sort(() => 0.5 - Math.random());
  let questionIndex = 0;

  while (appliedEffects < maxEffects) {
    // While we haven't already applied effects to all possible cells
    // Choose weighted effect category
    const chosenEffectIndex = weightedRandomCategory(categories, weights);
    const chosenCategory = categories[chosenEffectIndex];

    const cell = Math.floor(Math.random() * availableCells) + 2;

    if (excludedCells.has(cell)) continue;

    if (chosenCategory === "cell") {
      const move =
        Math.floor(Math.random() * (cellEffectRange * 2 + 1)) - cellEffectRange;
      if (!move) continue;

      const target = cell + move;
      if (target < 1 || target >= totalCells) continue;

      finalEffect[cell] = { type: "cell", move };
    } else if (chosenCategory === "question") {
      const numQuestions =
        Math.floor(Math.random() * (maxQuestions - minQuestions + 1)) +
        minQuestions;
      const questsIta = {};
      const questsEng = {};
      // Iterate trough chosen question count
      for (let i = 0; i < numQuestions; ++i) {
        // If we exhausted the pool, reshuffle and reset
        if (questionIndex >= shuffledQuestionsIta.length) {
          shuffledQuestionsIta = [...questionsIta].sort(() => 0.5 - Math.random());
          shuffledQuestionsEng = [...questionsEng].sort(() => 0.5 - Math.random());
          questionIndex = 0;
        }

        questsIta[i] = shuffledQuestionsIta[questionIndex];
        questsEng[i] = shuffledQuestionsEng[questionIndex];
        questionIndex++;
      }

      finalEffect[cell] = { type: "question", questsIta: questsIta, questsEng: questsEng  };
    } else if (chosenCategory === "death") {
      finalEffect[cell] = { type: "death" };
    } else if (chosenCategory === "bonus") {
      finalEffect[cell] = { type: "bonus" };
    }

    excludedCells.add(cell);
    categoryCounts[chosenEffectIndex]++;
    appliedEffects++;
  }

  return finalEffect;
}
